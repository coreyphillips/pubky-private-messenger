<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pubky Private Messenger</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<div id="app">
  <!-- Login Screen -->
  <div id="login-screen" class="screen">
    <div class="login-container">
      <h1>üîê Pubky Private Messenger</h1>
      <div class="form-group">
        <label for="recovery-file">Recovery File:</label>
        <input type="file" id="recovery-file" accept=".pkarr">
      </div>
      <div class="form-group">
        <label for="passphrase">Passphrase:</label>
        <input type="password" id="passphrase" placeholder="Enter your passphrase">
      </div>
      <button id="sign-in-btn" class="btn-primary">Sign In</button>
      <div id="login-error" class="error-message"></div>
    </div>
  </div>

  <!-- Chat Screen -->
  <div id="chat-screen" class="screen hidden">
    <div class="chat-container">
      <!-- Header -->
      <div class="chat-header">
        <div class="user-info">
          <span id="user-pubkey"></span>
          <button id="settings-btn" class="btn-secondary" title="Settings">‚öôÔ∏è</button>
          <button id="sign-out-btn" class="btn-secondary">Sign Out</button>
        </div>
      </div>

      <!-- Main Chat Area -->
      <div class="chat-main">
        <!-- Contacts Sidebar -->
        <div class="contacts-sidebar">
          <h3>Contacts</h3>
          <div class="add-contact">
            <input type="text" id="new-contact" placeholder="Enter public key">
            <button id="add-contact-btn">Add</button>
          </div>
          <div id="contacts-list"></div>
        </div>

        <!-- Chat Area -->
        <div class="chat-area">
          <div class="chat-header-conversation">
            <h3 id="conversation-title">Select a contact to start chatting</h3>
          </div>
          <div id="messages-container" class="messages-container"></div>
          <div class="message-input-container">
            <input type="text" id="message-input" placeholder="Type a message..." disabled>
            <button id="send-btn" disabled>Send</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Settings Panel -->
  <div id="settings-panel" class="settings-overlay hidden">
    <div class="settings-modal">
      <div class="settings-header">
        <h2>‚öôÔ∏è Settings</h2>
        <button id="close-settings-btn" class="close-btn">√ó</button>
      </div>

      <div class="settings-content">
        <!-- Message Polling Settings -->
        <div class="setting-group">
          <h3>Message Polling</h3>

          <div class="setting-item">
            <label class="setting-label">
              <input type="checkbox" id="polling-enabled" checked>
              <span class="setting-name">Enable background message checking</span>
            </label>
            <p class="setting-description">
              Automatically check for new messages in the background. Disable to save battery or bandwidth.
            </p>
          </div>

          <div class="setting-item">
            <label class="setting-label">
              <span class="setting-name">Check frequency</span>
            </label>
            <select id="polling-interval" class="setting-select">
              <option value="3000">Every 3 seconds</option>
              <option value="5000" selected>Every 5 seconds</option>
              <option value="10000">Every 10 seconds</option>
              <option value="30000">Every 30 seconds</option>
              <option value="60000">Every minute</option>
            </select>
            <p class="setting-description">
              How often to check for new messages. More frequent = more responsive but uses more resources.
            </p>
          </div>
        </div>

        <!-- NEW: Pubky Sync Settings -->
        <div class="setting-group">
          <h3>Pubky Integration</h3>

          <div class="setting-item">
            <label class="setting-label">
              <input type="checkbox" id="pubky-sync-enabled" checked>
              <span class="setting-name">Sync contacts from Pubky follows</span>
            </label>
            <p class="setting-description">
              Automatically import your followed users from Pubky as contacts when you sign in.
              This will fetch their profile names and make it easier to start conversations.
              Your custom contact names will never be overwritten.
            </p>
          </div>
        </div>
      </div>

      <div class="settings-footer">
        <button id="save-settings-btn" class="btn-primary">Save Settings</button>
      </div>
    </div>
  </div>
</div>

<script src="main.js"></script>
</body>
</html>